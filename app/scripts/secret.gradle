static def SECRET_PROPERTIES() { 'secret.properties' }

static def KEYSTORE_FILE() { 'KEYSTORE_FILE' }

static def KEYSTORE_PASSWORD() { 'KEYSTORE_PASSWORD' }

static def KEY_ALIAS() { 'KEY_ALIAS' }

static def KEY_PASSWORD() { 'KEY_PASSWORD' }

// secret.properties contains parameters of Upload Key (not Release Key)
def getSecret(String propertyKey) {
    try {
        Properties secretProperties = new Properties()
        file(SECRET_PROPERTIES()).withInputStream { secretProperties.load(it) }
        def propertyValue = secretProperties[propertyKey]
        propertyValue = propertyValue.trim()
        if (!propertyValue) {
            throw new Exception()
        }
        return propertyValue
    } catch (ignored) {
        throw new IllegalArgumentException("You should define ${KEYSTORE_FILE}, ${KEYSTORE_PASSWORD}, ${KEY_ALIAS}, ${KEY_PASSWORD} in ${SECRET_PROPERTIES}.")
    }
}

def getKeystoreFile() {
    return file(getSecret(KEYSTORE_FILE()))
}

def getKeystorePassword() {
    return getSecret(KEYSTORE_PASSWORD())
}

def getKeyAlias() {
    return getSecret(KEY_ALIAS())
}

def getKeyPassword() {
    return getSecret(KEY_PASSWORD())
}

ext {
    getSecretKeystoreFile = this.&getKeystoreFile
    getSecretKeystorePassword = this.&getKeystorePassword
    getSecretKeyAlias = this.&getKeyAlias
    getSecretKeyPassword = this.&getKeyPassword
}
